!function t(e,n,o){function r(a,s){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(i)return i(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){var n=e[a][1][t];return r(n?n:t)},u,u.exports,t,e,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(t,e,n){"use strict";var o={fontNo:"6",dpi:203};n.config=o},{}],2:[function(t){"use strict";t("./src/components/component"),t("./src/components/text"),t("./src/components/rect"),t("./src/components/ellipse"),t("./src/components/line"),t("./src/components/image"),t("./src/components/barcode"),t("./src/components/scene")},{"./src/components/barcode":3,"./src/components/component":4,"./src/components/ellipse":5,"./src/components/image":6,"./src/components/line":10,"./src/components/rect":11,"./src/components/scene":12,"./src/components/text":13}],3:[function(t,e,n){"use strict";function o(t){switch(t){case"ean8":1==barWidth?left+=20:2==barWidth?left+=25:3==barWidth?left+=25:4==barWidth?left+=35:5==barWidth?left+=20:6==barWidth?left+=50:7==barWidth?left+=50:8==barWidth?left+=75:9==barWidth&&(left+=75);break;case"ean13":1==barWidth?left+=20:2==barWidth?left+=25:3==barWidth?left+=25:4==barWidth?left+=35:5==barWidth?left+=20:6==barWidth?left+=50:7==barWidth?left+=50:8==barWidth?left+=75:9==barWidth&&(left+=75);break;case"upce":break;case"upca":}}var r=t("../../config").config,i={1:2,2:3,3:5,4:6,5:8,6:10},a=["qrcode","pdf417","micropdf417","datamatrix","maxicode","code49"];"ean8"!=symbol&&"ean13"!=symbol&&"upce"!=symbol&&"upca"!=symbol||!showText||o(symbol),scene.Barcode.prototype._toZpl=function(t){var e=this.model,n=e.symbol,o=e.scale_w,s=void 0===o?1:o,c=e.showText,h=void 0===c?!0:c,u=e.textAbove,p=void 0===u?"":u,f=this.labelingBounds,l=f.left,d=f.top,b=f.width,g=f.height,m=t?this.get("text"):this.text,v=this.orientation,y=[],x=2,M="R"==v||"B"==v?b:g,w=s;w=1>w?1:Math.floor(w),"ean8"!=n&&"ean13"!=n&&"upce"!=n&&"upca"!=n||!h||(1==w?l+=20:2==w?l+=25:3==w?l+=25:4==w?l+=35:5==w?l+=20:6==w?l+=50:7==w?l+=50:8==w?l+=75:9==w&&(l+=75)),y.push(["^BY"+w,x,M]),y.push(["^FO"+l,d]),h&&-1==a.indexOf(n)&&(M-=6*s+8);r.dpi;switch(h=h?"Y":"N",n){case"code11":y.push(["^B1"+v,,M,h,p]);break;case"interleaved2of5":y.push(["^B2"+v,M,h,p,"N"]);break;case"code39":y.push(["^B3"+v,"N",M,h,p]);break;case"code49":y.push(["^B4"+v,M,h]);break;case"planet":y.push(["^B5"+v,M,h,p]);break;case"pdf417":y.push(["^B7"+v,M,,,,]);break;case"ean8":y.push(["^B8"+v,M,h,p]);break;case"upce":y.push(["^B9"+v,M,h,p]);break;case"code93":y.push(["^BA"+v,M,h,p]);break;case"codablock":y.push(["^BB"+v,M,,,,]);break;case"code128":y.push(["^BC"+v,M,h,p,,]);break;case"maxicode":y.push(["^BD"+v,,M,h,p]);break;case"ean13":y.push(["^BE"+v,M,h,p]);break;case"micropdf417":y.push(["^BF"+v,M,"2"]);break;case"industrial2of5":y.push(["^BI"+v,M,h,p]);break;case"standard2of5":y.push(["^BJ"+v,M,h,p]);break;case"ansicodabar":y.push(["^BK"+v,,M,h,p,,]);break;case"logmars":y.push(["^BL"+v,M,p]);break;case"msi":y.push(["^BM"+v,,M,h,p,"N","N"]);break;case"plessey":y.push(["^BP"+v,"Y",M,h,p]);break;case"qrcode":w=i[Math.round(s)]?i[s]:i[6],y.push(["^BQ"+v,2,w]);break;case"upca":y.push(["^BU"+v,M,h,p]);break;case"datamatrix":y.push(["^BX"]);break;case"postal":y.push(["^BZ"+v,M,h,p])}"qrcode"===n?(y.push(["^FDQ","A"+m]),y.push(["^FS"])):"code39"===n?y.push(["^FD"+m+"^FS"]):(y.push(["^FD"+m]),y.push(["^FS"]));var B=y.map(function(t){return t.join(",")}).join("\n")+"\n";return B},n.Barcode=scene.Barcode},{"../../config":1}],4:[function(t,e,n){"use strict";function o(t){return"black"===t||"#000"===t||"#000000"===t}var r=t("../../config").config,i=15,a={NORMAL:"N",ROTATE_90:"R",INVERTED_180:"I",BOTTOM_UP_270:"B"};scene.Component.prototype.toZpl=function(t,e){var n=this;return new Promise(function(o,r){try{o(n._toZpl(t,e))}catch(i){r(i)}})},scene.Container.prototype.toZpl=function(t){var e=this;return new Promise(function(n,o){var r=e.components.map(function(e){return e.toZpl(t)});Promise.all(r).then(function(t){n(t.filter(function(t){return!!t}).join("\n"))},function(t){o(t)})})},Object.defineProperty(scene.Component.prototype,"labelingRatio",{get:function(){var t=r.dpi/2.54/10,e=.1;return t*e}}),Object.defineProperty(scene.Component.prototype,"lineColor",{get:function(){var t=this.model,e=t.strokeStyle,n=t.fillStyle;return o(e)||o(n)?"B":"W"}}),Object.defineProperty(scene.Component.prototype,"lineWidth",{get:function(){var t=this.model.lineWidth;return Math.round(t*this.labelingRatio)}}),Object.defineProperty(scene.Component.prototype,"borderThickness",{get:function(){var t=this.model,e=t.lineWidth,n=t.fill,o=this.labelingBounds,r=o.width,i=o.height;return Math.round(n?Math.min(r,i)/2:e*this.labelingRatio)}}),Object.defineProperty(scene.Component.prototype,"fontSize",{get:function(){var t=this.get("fontSize")||i;return t}}),Object.defineProperty(scene.Component.prototype,"labelingTextBounds",{get:function(){var t=this.textBounds,e=t.left,n=t.top,o=t.width,r=t.height;r=this.get("fontSize")||DEFAULT.FONT_SIZE;var i=this.transcoordS2T(e,n),a=this.transcoordS2T(e+o,n+r),e=Math.min(i.x,a.x)*this.labelingRatio,n=Math.min(i.y,a.y)*this.labelingRatio,o=Math.abs(a.x-i.x)*this.labelingRatio,r=Math.abs(a.y-i.y)*this.labelingRatio;return{left:Math.round(e),top:Math.round(n),width:Math.round(o),height:Math.round(r)}}}),Object.defineProperty(scene.Component.prototype,"labelingBounds",{get:function(){var t=this.bounds,e=t.left,n=t.top,o=t.width,r=t.height,i=this.transcoordS2T(e,n),a=this.transcoordS2T(e+o,n+r),e=Math.min(i.x,a.x)*this.labelingRatio,n=Math.min(i.y,a.y)*this.labelingRatio,o=Math.abs(a.x-i.x)*this.labelingRatio,r=Math.abs(a.y-i.y)*this.labelingRatio;return{left:Math.round(e),top:Math.round(n),width:Math.round(o),height:Math.round(r)}}}),Object.defineProperty(scene.Component.prototype,"absoluteRotation",{get:function(){for(var t=0,e=this;e;)t+=e.get("rotation")||0,e=e.parent;return t}}),Object.defineProperty(scene.Component.prototype,"orientation",{get:function(){var t=this.absoluteRotation%(2*Math.PI);return Math.PI*-.25<t&&t<=.25*Math.PI?a.NORMAL:.25*Math.PI<t&&t<=.75*Math.PI?a.ROTATE_90:.75*Math.PI<t&&t<=1.25*Math.PI||-1.25*Math.PI<t&&t<=Math.PI*-.75?a.INVERTED_180:Math.PI<1.25*t&&t<=1.75*Math.PI||Math.PI*-.75<t&&t<=Math.PI*-.25?a.BOTTOM_UP_270:void 0}}),n.Component=scene.Component},{"../../config":1}],5:[function(t,e,n){"use strict";t("./text"),scene.Component.prototype.toZplForEllipse=function(t,e,n){var o=t.top,r=t.left,i=t.width,a=t.height,s=this.model,c=s.fill,h=s.lineWidth,u=[],p=Math.round(h/3),f=c?p:0;return u.push(["^FO"+(r-p),o-p]),u.push(i===a?["^GC"+(i+2*p),n+f,e]:["^GE"+(i+2*p),a+2*p,n+f,e]),u.push(["^FS"]),u.map(function(t){return t.join(",")}).join("\n")+"\n"},scene.Ellipse.prototype._toZpl=function(t,e){if(!e){var n=this.toZplForEllipse(this.labelingBounds,this.lineColor,this.borderThickness);return(t?this.get("text"):this.text)&&(n+=this.toZplForText(t,e)),n}},n.Ellipse=scene.Ellipse},{"./text":13}],6:[function(t,e,n){"use strict";var o=t("../utils/to-grf");scene.ImageView.prototype.toZpl=function(t,e){var n=this;if(!e){var r=this.model.src;return new Promise(function(t,e){o.getGrfCommand(n.labelingBounds,"string"==typeof r?n.app.url(r):r).then(function(e){t(e)},function(t){e(t)})})}},n.Image=scene.ImageView},{"../utils/to-grf":16}],7:[function(t,e,n){"use strict";function o(){scene.Barcode.prototype.draw=function(){}}function r(){scene.Barcode.prototype.draw=i}Object.defineProperty(n,"__esModule",{value:!0}),n.drawBarcodeBefore=o,n.drawBarcodeAfter=r;var i=scene.Barcode.prototype.draw},{}],8:[function(t,e,n){"use strict";function o(){scene.Component.prototype.drawText=function(t){return i.hasVariables(this.get("text"))?void 0:a.call(this,t)}}function r(){scene.Component.prototype.drawText=a}Object.defineProperty(n,"__esModule",{value:!0}),n.drawTextBefore=o,n.drawTextAfter=r;var i=t("../../utils/has-variables"),a=scene.Component.prototype.drawText},{"../../utils/has-variables":14}],9:[function(t,e,n){"use strict";function o(t){t&&i.drawTextBefore(),a.drawBarcodeBefore()}function r(t){a.drawBarcodeAfter(),t&&i.drawTextAfter()}Object.defineProperty(n,"__esModule",{value:!0}),n.beforeDraw=o,n.afterDraw=r;var i=t("./draw-text"),a=t("./barcode-draw")},{"./barcode-draw":7,"./draw-text":8}],10:[function(t,e,n){"use strict";t("./rect"),t("./text"),scene.Component.prototype.toZplForLine=function(t,e,n,o){var r=t.left,i=t.top,a=t.width,s=t.height,c=[["^FO"+r,i],["^GD"+a,s,n,e,o],["^FS"]];return c.map(function(t){return t.join(",")}).join("\n")+"\n"},scene.Line.prototype._toZpl=function(t,e){if(!e){var n,o=this.labelingBounds;if(o.width<.5||o.height<.5)0==o.width?(o.left-=this.borderThickness/2,o.width+=this.borderThickness/2):0==o.height&&(o.top-=this.borderThickness/2,o.height+=this.borderThickness/2),n=this.toZplForRect(o,this.lineColor,this.borderThickness,0);else{var r=this.model,i=r.x1,a=r.x2,s=r.y1,c=r.y2,h=this.transcoordS2T(i,s),u=this.transcoordS2T(a,c),p=(h.x-u.x)*(h.y-u.y)>0?"L":"R";n=this.toZplForLine(o,this.lineColor,this.lineWidth,p)}return(t?this.get("text"):this.text)&&(n+=this.toZplForText(t,e)),n}},n.Line=scene.Line},{"./rect":11,"./text":13}],11:[function(t,e,n){"use strict";t("./text"),scene.Component.prototype.toZplForRect=function(t,e,n,o){var r=t.top,i=t.left,a=t.width,s=t.height,c=this.model,h=c.fill,u=c.lineWidth,p=c.type,f="rect"==p?Math.round(u/3):0,l=h?f:0,d=[["^FO"+(i-f),r-f],["^GB"+(a+2*f),s+2*f,n+l,e,Math.round(8*o/100)],["^FS"]];return d.map(function(t){return t.join(",")}).join("\n")+"\n"},scene.Rect.prototype._toZpl=function(t,e){if(!e){var n=this.model.round,o=void 0===n?0:n,r=this.toZplForRect(this.labelingBounds,this.lineColor,this.borderThickness,o);return(t?this.get("text"):this.text)&&(r+=this.toZplForText(t,e)),r}},n.Rect=scene.Rect},{"./text":13}],12:[function(t,e,n){"use strict";var o=t("../utils/to-grf"),r=t("./interceptors"),i=t("../../config").config;scene.Scene.prototype.toGRF=function(){var t=this.root.bounds,e=this.root.labelingRatio;return t.width=Math.round(t.width*e),t.height=Math.round(t.height*e),o.getGrfCommand(t,this.toDataURL(void 0,void 0,t.width,t.height))},scene.Scene.prototype.toTemplateGRF=function(t){var e=this,n=[];return this.root.traverse(function(t){n.push(new Promise(function(e,n){t.prepare(e,n)})),n.push(new Promise(function(e,n){t.prepareFill(e,n)}))},this),new Promise(function(i,a){Promise.all(n).then(function(){var n=e.root.bounds,s=n.left,c=n.top,h=n.width,u=n.height,p=e.root.labelingRatio,f=Math.round(s*p),l=Math.round(c*p),d=Math.round(h*p),b=Math.round(u*p),g=scene.Component.createCanvas(d*scene.DPPX,b*scene.DPPX),m=e.root.get("translate"),v=e.root.get("scale");e.root.set("translate",{x:0,y:0}),e.root.set("scale",{x:d/h,y:b/u});var y=g.getContext("2d");r.beforeDraw(t),e.root.draw(y),r.afterDraw(t),e.root.set("translate",m),e.root.set("scale",v);var x=[];x.push(o.getGrfCommand({left:f,top:l,width:d,height:b},g.toDataURL())),t&&e.root.forEach(function(e){x.push(e.toZpl(t,!0))}),Promise.all(x).then(function(t){i(t.filter(function(t){return!!t}).join("\n"))},function(t){a(t)})},function(t){console.error(t),a(t)})})},scene.Scene.prototype.toZpl=function(t,e,n){var o=this,r=i.dpi;n&&(i.dpi=n);var a=Number(this.root.get("width"))/100;return new Promise(function(n,s){e?o.toTemplateGRF(t).then(function(t){var e=Math.round(a/2.54*i.dpi);n(["^XA","^PW"+e+"\n",t,"^XZ"].join("\n")),i.dpi=r},function(t){s(t),i.dpi=r}):o.root.toZpl(t,e).then(function(t){var e=Math.round(a/2.54*i.dpi);n(["^XA","^PW"+e+"\n",t,"^XZ"].join("\n")),i.dpi=r},function(t){s(t),i.dpi=r})})},n.Scene=scene.Scene},{"../../config":1,"../utils/to-grf":16,"./interceptors":9}],13:[function(t,e,n){"use strict";var o=t("../utils/has-variables"),r=(t("../../config").config,100);scene.Component.prototype.toZplForText=function(t,e){if(!e||o.hasVariables(this.get("text"))){var n,i=this.model,a=i.textAlign,s=(i.textBaseline,i.fontCode),c=void 0===s?"6":s,h=this.labelingTextBounds,u=h.left,p=h.top,f=h.width,l=(h.height,this.orientation),d=Math.round((this.lineHeight-this.fontSize)*this.labelingRatio),b=t?this.get("text"):this.text,g=this.fontSize*this.labelingRatio,m=this.fontSize*this.labelingRatio,v=c;switch(a){case"right":n="R";break;case"justify":n="J";break;case"center":n="C";break;case"left":default:n="L"}var y=0;-1!=b.indexOf("\n")&&(b=b.replace(/\n/g,"\\&\n"));var x=[["^FO"+u,p],["^A"+v+l,Math.round(g),Math.round(m)],["^FB"+f,r,d,n,y],["^FD"+b],["^FS"]];return x.map(function(t){return t.join(",")}).join("\n")+"\n"}},scene.Text.prototype._toZpl=function(t,e){return this.toZplForText(t,e)},n.Text=scene.Text},{"../../config":1,"../utils/has-variables":14}],14:[function(t,e,n){"use strict";function o(t){return t?-1!==t.search(/#{(\S*)}/)?!0:-1!==t.search(/\${[^}]*}/)?!0:!1:!1}Object.defineProperty(n,"__esModule",{value:!0}),n.hasVariables=o},{}],15:[function(t,e,n){"use strict";function o(t,e,n){for(var o=[],r=0;e>r;r++)for(var i=0;t>i;i++){var a=4*(t*r+i),s=.21*n[a+c]+.71*n[a+h]+.07*n[a+u];s+=(255-n[a+p])*(255-s)/255,o[a+c]=s,o[a+h]=s,o[a+u]=s,o[a+p]=n[a+p]}return o}function r(t,e,n){for(var o=[],r=0;s>r;r++)o[r]=0;for(var i=0;e>i;i++)for(var a=0;t>a;a++){var h=4*(t*i+a),u=Math.round(n[h+c]);o[u]++}return o}function i(t,e,n){for(var o=r(t,e,n),i=0,a=0;s>a;a++)i+=a*o[a];for(var c=0,h=0,u=0,p=0,f=0,l=t*e,d=0;s>d;d++)if(h+=o[d],0!=h){if(u=l-h,0==u)break;c+=d*o[d];var b=c/h,g=(i-c)/u,m=h*u*(b-g)*(b-g);m>p&&(p=m,f=d)}return f}function a(t,e,n){for(var r=o(t,e,n),a=i(t,e,r),s=[],f=0;e>f;f++)for(var l=0;t>l;l++){var d=4*(f*t+l);r[d]>a?(s[d+c]=255,s[d+h]=255,s[d+u]=255):(s[d+c]=0,s[d+h]=0,s[d+u]=0),s[d+p]=r[d+p]}return s}Object.defineProperty(n,"__esModule",{value:!0}),n.binarize=a;var s=256,c=0,h=1,u=2,p=3},{}],16:[function(t,e,n){"use strict";function o(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()+t()+t()+t()+t()}function r(t){return parseInt(t,2).toString(16).toUpperCase()||""}function i(t,e,n){for(var o="",i=Math.ceil(t/8),a=0;e>a;a++){for(var s="",c=0,h=0;t>h;h++)s+=0==n[4*(t*a+h)+1]?"1":"0",s.length>7&&(o+=r(s.substring(0,4))+r(s.substring(4,8)),s="",c++);if(s.length>0){for(;s.length<8;)s+="0";o+=r(s.substring(0,4))+r(s.substring(4,8)),s="",c++}for(;c++<i;)o+=r("0000")+r("0000");o+="\n"}return i*e+","+i+","+o}function a(t,e,n){var o;"undefined"==typeof document?o=new Canvas(t,e):(o=document.createElement("canvas"),o.width=t,o.height=e);var r=new Image,a=new Promise(function(n,a){r.onload=function(){var a=o.getContext("2d");a.drawImage(r,0,0,this.width,this.height,0,0,t,e);var s=a.getImageData(0,0,t,e),h=s.data,u=i(t,e,c.binarize(t,e,h));"undefined"!=typeof document&&o.remove(),n(u)},r.onerror=function(t){o.remove(),a(t)}});return r.crossOrigin="use-credentials",r.src=n,a}function s(t,e){return new Promise(function(n,r){a(Math.round(t.width),Math.round(t.height),e).then(function(e){var r=o(),i=[["~DG"+r,e],["^FO"+Math.round(t.left),Math.round(t.top)],["^XGR:"+r,1,1],["^PQ1"],["^FS"]],a=i.map(function(t){return t.join(",")}).join("\n")+"\n";n(a)},function(t){r(t)})})}Object.defineProperty(n,"__esModule",{value:!0}),n.getImageGrf=a,n.getGrfCommand=s;var c=t("./rgb-binarize")},{"./rgb-binarize":15}]},{},[2]);